apiVersion: tekton.dev/v1beta1
kind: Task
metadata:
  name: download-and-unzip-image
spec:
  params:
    - name: nexusUrl
      description: URL of the image in Nexus
    - name: destinationPath
      description: The path where the image should be unzipped
    - name: fileName
      description: The name of the file to download
  steps:
    - name: download-image
      image: curlimages/curl:latest
      script: |
        #!/bin/sh
        echo "Downloading image from Nexus..."
        curl -L -o $(workspaces.download-path.path)/$(params.fileName) $(params.nexusUrl)
    - name: unzip-image
      image: busybox
      script: |
        #!/bin/sh
        echo "Unzipping image..."
        unzip $(workspaces.download-path.path)/$(params.fileName) -d $(params.destinationPath)
  workspaces:
    - name: download-path
      description: Workspace to download the image to and unzip
