spring-petclinic-configmap.yaml
-------------------------------------
apiVersion: v1
kind: ConfigMap
metadata:
  name: petclinic-configmap
data:
  application.properties: |
    spring.datasource.url=jdbc:mysql://mysql-service:3306/petclinicdb?useSSL=false
    spring.datasource.username=petclinicuser
    spring.datasource.password=petclinicpassword


mysql-deployment.yaml
--------------------------------------------------------------
apiVersion: apps/v1
kind: Deployment
metadata:
  name: mysql
spec:
  replicas: 1
  selector:
    matchLabels:
      app: mysql
  template:
    metadata:
      labels:
        app: mysql
    spec:
      containers:
        - name: mysql
          image: mysql:latest
          env:
            - name: MYSQL_ROOT_PASSWORD
              value: myrootpassword
            - name: MYSQL_DATABASE
              value: petclinicdb
            - name: MYSQL_USER
              value: petclinicuser
            - name: MYSQL_PASSWORD
              value: petclinicpassword
          ports:
            - containerPort: 3306
          volumeMounts:
            - name: mysql-persistent-storage
              mountPath: /var/lib/mysql
      volumes:
        - name: mysql-persistent-storage
          persistentVolumeClaim:
            claimName: mysql-pvc


petclinic-deployment.yaml
----------------------------------------

apiVersion: apps/v1
kind: Deployment
metadata:
  name: petclinic
spec:
  replicas: 1
  selector:
    matchLabels:
      app: petclinic
  template:
    metadata:
      labels:
        app: petclinic
    spec:
      containers:
        - name: petclinic
          image: spring-petclinic:latest
          ports:
            - containerPort: 8080
          volumeMounts:
            - name: petclinic-persistent-storage
              mountPath: /tmp
            - name: petclinic-config   # Adding the ConfigMap volume mount
              mountPath: /config       # Mount path inside the container
              readOnly: true           # Read-only access to ConfigMap
      volumes:
        - name: petclinic-persistent-storage
          persistentVolumeClaim:
            claimName: petclinic-pvc
        - name: petclinic-config      # ConfigMap volume definition
          configMap:
            name: petclinic-configmap


mysql-pvc.yaml
----------------------------------------------------
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: mysql-pvc
spec:
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 5Gi  # Adjust the storage size as needed


mysql-service.yaml
---------------------------------------------------------
apiVersion: v1
kind: Service
metadata:
  name: mysql-service
spec:
  selector:
    app: mysql
  ports:
    - protocol: TCP
      port: 3306
      targetPort: 3306






commands
-----------------------
kubectl apply -f spring-petclinic-configmap.yaml
kubectl apply -f mysql-deployment.yaml
kubectl apply -f petclinic-deployment.yaml
kubectl apply -f spring-petclinic-service.yaml
kubectl apply -f mysql-service.yaml



